import{e as M,r as C,f as O,o as c,c as S,a as l,t as f,d as x,g as b,v as D,h as d,i as B,j as R,F as E,k as j,l as I,m as $,n as F}from"./C3nfCIZs.js";const J={class:"modal"},L=M({__name:"TaskModal",props:{task:{}},emits:["close","save"],setup(e,{emit:t}){const T=e,p=t,u=C({id:"",title:"",description:"",dueDate:"",isCompleted:!1,createdAt:"",updatedAt:""});O(()=>T.task,k=>{k?u.value={...u.value,...k}:u.value={id:"",title:"",description:"",dueDate:"",isCompleted:!1,createdAt:"",updatedAt:""}},{immediate:!0});const g=()=>{u.value.id||(u.value.createdAt=new Date().toISOString()),u.value.updatedAt=new Date().toISOString(),p("save",{...u.value}),p("close")};return(k,o)=>(c(),S("div",J,[l("h2",null,f(k.task?"編輯任務":"新增任務"),1),l("form",{onSubmit:B(g,["prevent"])},[l("label",null,[o[4]||(o[4]=x(" 標題: ")),b(l("input",{"onUpdate:modelValue":o[0]||(o[0]=n=>d(u).title=n),required:"",maxlength:"100"},null,512),[[D,d(u).title]])]),l("label",null,[o[5]||(o[5]=x(" 描述: ")),b(l("textarea",{"onUpdate:modelValue":o[1]||(o[1]=n=>d(u).description=n),maxlength:"500"},null,512),[[D,d(u).description]])]),l("label",null,[o[6]||(o[6]=x(" 到期日: ")),b(l("input",{type:"date","onUpdate:modelValue":o[2]||(o[2]=n=>d(u).dueDate=n)},null,512),[[D,d(u).dueDate]])]),o[7]||(o[7]=l("button",{type:"submit"},"保存",-1)),l("button",{type:"button",onClick:o[3]||(o[3]=n=>k.$emit("close"))},"取消")],32)]))}}),a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function q(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}let U;const H=new Uint8Array(16);function z(){if(!U){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");U=crypto.getRandomValues.bind(crypto)}return U(H)}const G=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),A={randomUUID:G};function K(e,t,T){if(A.randomUUID&&!t&&!e)return A.randomUUID();e=e||{};const p=e.random||(e.rng||z)();return p[6]=p[6]&15|64,p[8]=p[8]&63|128,q(p)}const r=C([]),P=()=>{const e=()=>{const n=localStorage.getItem("tasks");n&&(r.value=JSON.parse(n))},t=()=>{localStorage.setItem("tasks",JSON.stringify(r.value))};return{tasks:r,loadTasks:e,getTask:n=>r.value.find(s=>s.id===n),addTask:n=>{const s=K();return r.value.push({...n,id:s}),t(),s},updateTask:n=>{const s=r.value.findIndex(v=>v.id===n.id);s!==-1&&(r.value[s]=n,t())},deleteTask:n=>{r.value=r.value.filter(s=>s.id!==n),t()},markTaskCompleted:n=>{const s=r.value.find(v=>v.id===n);s&&(s.isCompleted=!0,s.updatedAt=new Date().toISOString(),t())},clearCompletedTasks:()=>{r.value=r.value.filter(n=>!n.isCompleted),t()}}},Q=["onUpdate:modelValue","onChange"],W=["onClick"],X=["onClick"],Z=M({__name:"index",setup(e){const{tasks:t,loadTasks:T,addTask:p,updateTask:u,deleteTask:g,markTaskCompleted:k,clearCompletedTasks:o}=P(),n=C(!1),s=C(!1),v=C(null),N=V=>{v.value=V,s.value=!0};return R(()=>{T()}),(V,m)=>{const w=L;return c(),S("div",null,[m[4]||(m[4]=l("h1",null,"待辦事項列表",-1)),l("button",{onClick:m[0]||(m[0]=i=>n.value=!0)},"新增任務"),l("button",{onClick:m[1]||(m[1]=(...i)=>d(o)&&d(o)(...i))},"清除完成任務"),l("ul",null,[(c(!0),S(E,null,j(d(t),i=>(c(),S("li",{key:`t_${i.id}`},[l("span",null,f(i.title),1),l("span",null,f(i.dueDate),1),b(l("input",{type:"checkbox","onUpdate:modelValue":y=>i.isCompleted=y,onChange:y=>d(k)(i.id)},null,40,Q),[[F,i.isCompleted]]),l("button",{onClick:y=>N(i)},"編輯",8,W),l("button",{onClick:y=>d(g)(i.id)},"刪除",8,X)]))),128))]),d(n)?(c(),I(w,{key:0,onClose:m[2]||(m[2]=i=>n.value=!1),onSave:d(p)},null,8,["onSave"])):$("",!0),d(s)&&d(v)?(c(),I(w,{key:1,task:d(v),onClose:m[3]||(m[3]=i=>s.value=!1),onSave:d(u)},null,8,["task","onSave"])):$("",!0)])}}});export{Z as default};
